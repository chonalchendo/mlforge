# v0.1.0 Roadmap

## Overview

v0.1.0 is the foundational release of mlforge—a simple, local-first feature store SDK. The focus is on core functionality, developer experience, and project infrastructure.

## Goals

1. Users can define features in Python with minimal boilerplate
2. Users can materialize features to local storage
3. Users can retrieve point-in-time correct training data
4. Project is published and documented

## Features Implemented

### SDK

**`@feature` decorator:**
```python
@feature(
    keys=["user_id"],
    source="data/transactions.csv",
    timestamp="feature_timestamp",
    description="User total spend",
)
def user_total_spend(df: pl.DataFrame) -> pl.DataFrame:
    return (
        df
        .pipe(with_user_id)
        .group_by("user_id")
        .agg(pl.col("amt").sum().alias("user_total_spend"))
    )
```

**`entity_key` utility:**
```python
from mlforge import entity_key

with_user_id = entity_key("first", "last", "dob", alias="user_id")
with_account_id = entity_key("cc_num", alias="account_id")
```

**`Definitions` class:**
```python
from mlforge import Definitions, LocalStore
from features import users, accounts

defs = Definitions(
    name="my-project",
    features=[users, accounts],
    offline_store=LocalStore(path="./feature_store"),
)
```

**`get_training_data` function:**
```python
from mlforge import get_training_data

training_df = get_training_data(
    features=["user_total_spend", "account_total_spend"],
    entity_df=entity_df,
    entities=[with_user_id, with_account_id],
    timestamp="trans_date_trans_time",
)
```

### Storage

**LocalStore:**
- Write features to local Parquet files
- Read features from local Parquet files
- Check if feature exists

### CLI

| Command | Description |
|---------|-------------|
| `mlforge build <definitions.py>` | Materialize features to storage |
| `mlforge list <definitions.py>` | List registered features |

**CLI Features:**
- Preview of materialized data after build
- `--force` flag to rebuild existing features
- `--no-preview` flag to skip preview
- `--tag` filtering (placeholder for v0.2.0)

### Utilities

| Utility | Description |
|---------|-------------|
| `surrogate_key(*columns)` | Generate hash key from columns |
| `entity_key(*columns, alias)` | Create reusable entity transform |

### Retrieval

- Standard joins for non-temporal features
- Point-in-time (asof) joins for temporal features
- Entity key transforms applied before joining
- Validation of entity columns before transform

### Error Handling

- `DefinitionsLoadError` — clear errors when loading definitions fails
- `FeatureMaterializationError` — clear errors when feature returns None or wrong type
- Timestamp dtype mismatch validation
- Missing entity columns validation

### Logging

- Loguru for system-level logging (debug, info, error)
- Rich for user-facing output (tables, previews, success/error messages)

---

## Remaining Work

### 1. Tests

**Definition of Done:**
- [x] ✅ Unit tests for `@feature` decorator
- [x] ✅ Unit tests for `Definitions` class
- [x] ✅ Unit tests for `LocalStore`
- [x] ✅ Unit tests for `entity_key` and `surrogate_key`
- [x] ✅ Unit tests for `load_definitions`
- [x] ✅ Unit tests for `get_training_data` (standard joins)
- [x] ✅ Unit tests for `get_training_data` (point-in-time joins)
- [ ] Unit tests for CLI commands
- [ ] Coverage >80%

**Completed:** Generated 80 comprehensive unit tests following Given-When-Then structure across 5 test files (`test_core.py`, `test_store.py`, `test_utils.py`, `test_loader.py`, `test_errors.py`) plus shared fixtures in `conftest.py`. Tests cover core functionality, edge cases, error handling, and validation for all implemented SDK components.

---

### 2. Commitizen Config

**Definition of Done:**
- [ ] Add `[tool.commitizen]` section to `pyproject.toml`
- [ ] Configure version location
- [ ] Configure tag format
- [ ] Verify `cz bump --changelog` works

**Config:**
```toml
[tool.commitizen]
name = "cz_conventional_commits"
version = "0.1.0"
tag_format = "v$version"
version_files = [
    "pyproject.toml:version",
    "src/mlforge/__init__.py:__version__",
]
```

---

### 3. CI/CD Pipeline

**Definition of Done:**
- [ ] GitHub Actions workflow created
- [ ] Runs on push to main and pull requests
- [ ] Runs `just check` (lint, type, format, security, tests)
- [ ] Caches uv dependencies
- [ ] Fails on any check failure

**Workflow file:** `.github/workflows/ci.yml`
```yaml
name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Install uv
        uses: astral-sh/setup-uv@v4
      
      - name: Set up Python
        run: uv python install 3.13
      
      - name: Install dependencies
        run: uv sync --all-extras --dev
      
      - name: Run checks
        run: |
          uv run ruff check src tests
          uv run ty check src tests
          uv run ruff format --check src tests
          uv run bandit --recursive --configfile=pyproject.toml src
          uv run pytest --cov=src --cov-fail-under=80 tests
```

---

### 4. Docker Image

**Definition of Done:**
- [ ] Dockerfile created
- [ ] Image builds successfully
- [ ] Image runs `mlforge` CLI
- [ ] Image published to GitHub Container Registry

**Dockerfile:**
```dockerfile
FROM python:3.13-slim

WORKDIR /app

# Install uv
RUN pip install uv

# Copy project
COPY pyproject.toml uv.lock ./
COPY src ./src

# Install dependencies
RUN uv sync --no-dev

# Set entrypoint
ENTRYPOINT ["uv", "run", "mlforge"]
```

---

### 5. Documentation

**Definition of Done:**
- [ ] MkDocs project initialized
- [ ] Getting started guide (<5 min to first feature)
- [ ] API reference for public functions/classes
- [ ] CLI reference
- [ ] Example project walkthrough
- [ ] Builds without errors

**Structure:**
```
docs/
├── index.md              # Overview
├── getting-started.md    # Quick start guide
├── features.md           # Defining features
├── retrieval.md          # Getting training data
├── cli.md                # CLI reference
├── api/
│   ├── feature.md
│   ├── definitions.md
│   ├── store.md
│   └── utils.md
└── examples/
    └── transactions.md   # Full example walkthrough
```

---

### 6. Publish to PyPI

**Definition of Done:**
- [ ] `pyproject.toml` has all required metadata
- [ ] README renders correctly on PyPI
- [ ] Package installs via `pip install mlforge`
- [ ] GitHub Actions workflow for publishing on release

**Required metadata:**
```toml
[project]
name = "mlforge"
description = "A simple feature store SDK for Python"
readme = "README.md"
license = { text = "MIT" }
authors = [{ name = "Your Name", email = "you@example.com" }]
classifiers = [
    "Development Status :: 3 - Alpha",
    "Intended Audience :: Developers",
    "License :: OSI Approved :: MIT License",
    "Programming Language :: Python :: 3.13",
]
keywords = ["feature-store", "mlops", "machine-learning"]
```

---

### 7. Publish Docker Image

**Definition of Done:**
- [ ] Image published to GitHub Container Registry (ghcr.io)
- [ ] Tagged with version (v0.1.0)
- [ ] README documents how to pull/run

**GitHub Actions step:**
```yaml
- name: Build and push Docker image
  uses: docker/build-push-action@v5
  with:
    push: true
    tags: ghcr.io/${{ github.repository }}:${{ github.ref_name }}
```

---

### 8. Publish Docs to GitHub Pages

**Definition of Done:**
- [ ] MkDocs builds and deploys via GitHub Actions
- [ ] Docs available at `https://<username>.github.io/mlforge`
- [ ] Deploys on release

**GitHub Actions:**
```yaml
- name: Deploy docs
  run: uv run mkdocs gh-deploy --force
```

---

### 9. Build Changelog

**Definition of Done:**
- [ ] CHANGELOG.md generated via commitizen
- [ ] Includes all commits since project start
- [ ] Grouped by type (feat, fix, refactor, etc.)

**Command:**
```bash
cz bump --changelog --increment MINOR
```

---

## Out of Scope for v0.1.0

| Feature | Reason |
|---------|--------|
| S3 storage | v0.2.0 |
| Feature tags | v0.2.0 |
| Aggregation helpers | v0.2.0 |
| Feature metadata | v0.2.0 |
| DuckDB backend | v0.3.0 |
| Online stores | v0.4.0+ |
| Orchestration integrations | v0.7.0+ |

---

## Release Checklist

- [ ] All tests passing
- [ ] `just check` passes
- [ ] Documentation complete
- [ ] CHANGELOG generated
- [ ] Version bumped to 0.1.0
- [ ] Tagged `v0.1.0`
- [ ] Published to PyPI
- [ ] Docker image published
- [ ] Docs published to GitHub Pages
- [ ] GitHub release created with notes

---

## Definition of Done for v0.1.0

> A user can `pip install mlforge`, define features in Python, materialize them locally, retrieve point-in-time correct training data, and find clear documentation to guide them. The project has CI/CD, tests, and is published to PyPI.